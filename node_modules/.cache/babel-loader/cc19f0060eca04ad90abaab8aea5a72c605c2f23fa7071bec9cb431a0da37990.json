{"ast":null,"code":"import { getRosterUserByPage } from \"./api.js\";\nimport departmentChoose from \"@/views/template/department-choose\";\nexport default {\n  name: \"add\",\n  components: {\n    departmentChoose\n  },\n  props: {\n    value: {\n      type: Boolean,\n      default: false\n    },\n    data: {\n      type: Object\n    }\n  },\n  watch: {\n    value(val) {\n      this.setCurrentValue(val);\n    },\n    visible(value) {\n      this.$emit(\"input\", value);\n    }\n  },\n  data() {\n    return {\n      showValue: false,\n      visible: this.value,\n      title: \"\",\n      submitLoading: false,\n      maxHeight: 510,\n      form: {},\n      formValidate: {},\n      roleList: [],\n      userColumns: [{\n        title: \"姓名\",\n        key: \"username\",\n        minWidth: 100,\n        sortable: true\n      }, {\n        title: \"部门\",\n        key: \"departmentTitle\",\n        minWidth: 150,\n        sortable: true\n      }, {\n        title: \"工号\",\n        key: \"jobnumber\",\n        sortable: true,\n        sortType: \"desc\",\n        minWidth: 100\n      }],\n      isImportHuaData: true,\n      huasearchForm: {\n        pageNumber: 1,\n        pageSize: 10,\n        username: \"\",\n        groupId: '',\n        departmentId: ''\n      },\n      selectHuaList: [],\n      selectHuaCount: [],\n      huaData: []\n    };\n  },\n  methods: {\n    init() {\n      this.getHuaUserList();\n    },\n    handleSelectDep(e) {\n      var that = this;\n      e.forEach(function (ee) {\n        that.huasearchForm.departmentId = ee.id;\n      });\n    },\n    huashowHuaSelect(e) {\n      this.$emit(\"submited\", e);\n      // console.log(e);\n    },\n    setCurrentValue(value) {\n      if (value === this.visible) {\n        return;\n      }\n      this.visible = value;\n    },\n    closeWindow() {\n      this.visible = false;\n    },\n    huahandleSearch() {\n      this.huasearchForm.pageNumber = 1;\n      this.huasearchForm.pageSize = 10;\n      this.getHuaUserList();\n    },\n    huahandleReset() {\n      this.$refs.huasearchForm.resetFields();\n      this.huasearchForm.nickname = '';\n      this.huasearchForm.pageNumber = 1;\n      this.huasearchForm.pageSize = 10;\n      this.huasearchForm.departmentId = '';\n      this.getHuaUserList();\n    },\n    huaclearSelectAll() {\n      this.$refs.table1.selectAll(false);\n    },\n    huachangePage(v) {\n      this.huasearchForm.pageNumber = v;\n      this.getHuaUserList();\n      this.huaclearSelectAll();\n    },\n    huachangePageSize(v) {\n      this.huasearchForm.pageSize = v;\n      this.getHuaUserList();\n    },\n    huaAddData() {\n      var that = this;\n      if (this.huaselectCount <= 0) {\n        this.$Message.warning(\"您还未选择要从花名册导入的数据\");\n        return;\n      }\n      this.$Modal.confirm({\n        title: \"确认导入\",\n        content: \"您确认要导入所选的 \" + this.huaselectCount + \" 条数据?\",\n        loading: true,\n        onOk: () => {\n          let ids = \"\";\n          this.huaselectList.forEach(function (e) {\n            ids += e.nickname + \",\";\n            ids = ids.substring(0, ids.length - 1);\n            this.$Modal.remove();\n            this.$Message.success(\"导入成功\");\n            this.isImportHuaData = false;\n            that.form.inPeople = ids;\n          });\n        }\n      });\n    },\n    getHuaUserList() {\n      this.hualoading = true;\n      getRosterUserByPage(this.huasearchForm).then(res => {\n        // getHuaListData\n        this.hualoading = false;\n        if (res.success) {\n          this.huaData = res.result.records;\n          this.huaTotal = res.result.total;\n        }\n      });\n    }\n  },\n  mounted() {\n    this.init();\n  }\n};","map":{"version":3,"names":["getRosterUserByPage","departmentChoose","name","components","props","value","type","Boolean","default","data","Object","watch","val","setCurrentValue","visible","$emit","showValue","title","submitLoading","maxHeight","form","formValidate","roleList","userColumns","key","minWidth","sortable","sortType","isImportHuaData","huasearchForm","pageNumber","pageSize","username","groupId","departmentId","selectHuaList","selectHuaCount","huaData","methods","init","getHuaUserList","handleSelectDep","e","that","forEach","ee","id","huashowHuaSelect","closeWindow","huahandleSearch","huahandleReset","$refs","resetFields","nickname","huaclearSelectAll","table1","selectAll","huachangePage","v","huachangePageSize","huaAddData","huaselectCount","$Message","warning","$Modal","confirm","content","loading","onOk","ids","huaselectList","substring","length","remove","success","inPeople","hualoading","then","res","result","records","huaTotal","total","mounted"],"sources":["src/views/ele/threeAdminAssets/userSelect.vue"],"sourcesContent":["<template>\r\n<div>\r\n    <Drawer title=\"导入花名册数据\" closable v-model=\"visible\" draggable width=\"1200\">\r\n        <car>\r\n            <Row>\r\n                <Form ref=\"huasearchForm\" :model=\"huasearchForm\" inline :label-width=\"70\">\r\n                    <Form-item label=\"部门\">\r\n                        <department-choose @on-change=\"handleSelectDep\" style=\"width: 600px\" ref=\"dep\"></department-choose>\r\n                    </Form-item>\r\n                    <Form-item label=\"姓名\">\r\n                        <Input type=\"text\" v-model=\"huasearchForm.username\" clearable placeholder=\"请输入姓名\" style=\"width: 200px\" />\r\n                    </Form-item>\r\n                    <Form-item label=\"工号\">\r\n                        <Input type=\"text\" v-model=\"huasearchForm.jobnumber\" clearable placeholder=\"请输入工号\" style=\"width: 200px\" />\r\n                    </Form-item>\r\n                    <Form-item>\r\n                        <Button @click=\"huahandleSearch\" type=\"primary\" icon=\"ios-search\">搜索</Button>\r\n                        <Button @click=\"huahandleReset\">重置</Button>\r\n                    </Form-item>\r\n                </Form>\r\n            </Row>\r\n            <Row v-show=\"openTip\">\r\n                <Alert show-icon>\r\n                    已选择\r\n                    <span class=\"select-count\">{{huaselectCount}}</span> 项\r\n                    <a class=\"select-clear\" @click=\"huaclearSelectAll\">清空</a>\r\n                </Alert>\r\n            </Row>\r\n            <Row>\r\n                <Table :loading=\"hualoading\" border :columns=\"userColumns\" :data=\"huaData\" sortable=\"custom\" @on-sort-change=\"huachangeSort\" @on-row-dblclick=\"huashowHuaSelect\" ref=\"table1\"></Table>\r\n                <br>\r\n            </Row>\r\n            <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n                <Page :current=\"huasearchForm.pageNumber\" :total=\"huaTotal\" :page-size=\"huasearchForm.pageSize\" @on-change=\"huachangePage\" @on-page-size-change=\"huachangePageSize\" :page-size-opts=\"[10,20,50]\" size=\"small\" show-total show-elevator show-sizer></Page>\r\n            </Row>\r\n            <span style=\"font-size:30px;color:#f00\">请双击员工选择领用人!</span><br>\r\n            <Button type=\"primary\" @click=\"closeWindow\">退出</Button>\r\n        </car>\r\n    </Drawer>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n    getRosterUserByPage\r\n} from \"./api.js\";\r\nimport departmentChoose from \"@/views/template/department-choose\";\r\nexport default {\r\n    name: \"add\",\r\n    components: {\r\n        departmentChoose\r\n    },\r\n    props: {\r\n        value: {\r\n            type: Boolean,\r\n            default: false\r\n        },\r\n        data: {\r\n            type: Object\r\n        },\r\n    },\r\n    watch: {\r\n        value(val) {\r\n            this.setCurrentValue(val);\r\n        },\r\n        visible(value) {\r\n            this.$emit(\"input\", value);\r\n        }\r\n    },\r\n    data() {\r\n        return {\r\n            showValue: false,\r\n            visible: this.value,\r\n            title: \"\",\r\n            submitLoading: false,\r\n            maxHeight: 510,\r\n            form: {},\r\n            formValidate: {},\r\n            roleList: [],\r\n            userColumns: [{\r\n                    title: \"姓名\",\r\n                    key: \"username\",\r\n                    minWidth: 100,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"部门\",\r\n                    key: \"departmentTitle\",\r\n                    minWidth: 150,\r\n                    sortable: true\r\n                },\r\n                {\r\n                    title: \"工号\",\r\n                    key: \"jobnumber\",\r\n                    sortable: true,\r\n                    sortType: \"desc\",\r\n                    minWidth: 100\r\n                }\r\n            ],\r\n            isImportHuaData: true,\r\n            huasearchForm: {\r\n                pageNumber: 1,\r\n                pageSize: 10,\r\n                username: \"\",\r\n                groupId: '',\r\n                departmentId: ''\r\n            },\r\n            selectHuaList: [],\r\n            selectHuaCount: [],\r\n            huaData: [],\r\n        };\r\n    },\r\n    methods: {\r\n        init() {\r\n            this.getHuaUserList();\r\n        },\r\n        handleSelectDep(e) {\r\n            var that = this;\r\n            e.forEach(function (ee) {\r\n                that.huasearchForm.departmentId = ee.id;\r\n            });\r\n        },\r\n        huashowHuaSelect(e) {\r\n            this.$emit(\"submited\", e);\r\n            // console.log(e);\r\n        },\r\n        setCurrentValue(value) {\r\n            if (value === this.visible) {\r\n                return;\r\n            }\r\n            this.visible = value;\r\n        },\r\n        closeWindow() {\r\n            this.visible = false;\r\n        },\r\n        huahandleSearch() {\r\n            this.huasearchForm.pageNumber = 1;\r\n            this.huasearchForm.pageSize = 10;\r\n            this.getHuaUserList();\r\n        },\r\n        huahandleReset() {\r\n            this.$refs.huasearchForm.resetFields();\r\n            this.huasearchForm.nickname = '';\r\n            this.huasearchForm.pageNumber = 1;\r\n            this.huasearchForm.pageSize = 10;\r\n            this.huasearchForm.departmentId = '';\r\n            this.getHuaUserList();\r\n        },\r\n        huaclearSelectAll() {\r\n            this.$refs.table1.selectAll(false);\r\n        },\r\n        huachangePage(v) {\r\n            this.huasearchForm.pageNumber = v;\r\n            this.getHuaUserList();\r\n            this.huaclearSelectAll();\r\n        },\r\n        huachangePageSize(v) {\r\n            this.huasearchForm.pageSize = v;\r\n            this.getHuaUserList();\r\n        },\r\n        huaAddData() {\r\n            var that = this;\r\n            if (this.huaselectCount <= 0) {\r\n                this.$Message.warning(\"您还未选择要从花名册导入的数据\");\r\n                return;\r\n            }\r\n            this.$Modal.confirm({\r\n                title: \"确认导入\",\r\n                content: \"您确认要导入所选的 \" + this.huaselectCount + \" 条数据?\",\r\n                loading: true,\r\n                onOk: () => {\r\n                    let ids = \"\";\r\n                    this.huaselectList.forEach(function (e) {\r\n                        ids += e.nickname + \",\";\r\n                        ids = ids.substring(0, ids.length - 1);\r\n                        this.$Modal.remove();\r\n                        this.$Message.success(\"导入成功\");\r\n                        this.isImportHuaData = false;\r\n                        that.form.inPeople = ids;\r\n                    })\r\n                }\r\n            })\r\n        },\r\n        getHuaUserList() {\r\n            this.hualoading = true;\r\n            getRosterUserByPage(this.huasearchForm).then(res => { // getHuaListData\r\n                this.hualoading = false;\r\n                if (res.success) {\r\n                    this.huaData = res.result.records;\r\n                    this.huaTotal = res.result.total;\r\n                }\r\n            });\r\n        },\r\n    },\r\n    mounted() {\r\n        this.init();\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.edit-head {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: space-between;\r\n    position: relative;\r\n\r\n    .back-title {\r\n        color: #515a6e;\r\n        display: flex;\r\n        align-items: center;\r\n    }\r\n\r\n    .head-name {\r\n        display: inline-block;\r\n        height: 20px;\r\n        line-height: 20px;\r\n        font-size: 16px;\r\n        color: #17233d;\r\n        font-weight: 500;\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        white-space: nowrap;\r\n    }\r\n\r\n    .window-close {\r\n        z-index: 1;\r\n        font-size: 12px;\r\n        position: absolute;\r\n        right: 0px;\r\n        top: -5px;\r\n        overflow: hidden;\r\n        cursor: pointer;\r\n\r\n        .ivu-icon-ios-close {\r\n            color: #999;\r\n            transition: color .2s ease;\r\n        }\r\n    }\r\n\r\n    .window-close .ivu-icon-ios-close:hover {\r\n        color: #444;\r\n    }\r\n}\r\n</style>\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}